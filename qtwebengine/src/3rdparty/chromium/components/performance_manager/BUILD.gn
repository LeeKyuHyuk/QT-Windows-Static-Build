# Copyright 2019 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

static_library("performance_manager") {
  sources = [
    "decorators/page_live_state_decorator.cc",
    "decorators/page_load_tracker_decorator.cc",
    "decorators/page_load_tracker_decorator.h",
    "decorators/page_load_tracker_decorator_helper.cc",
    "decorators/tab_properties_decorator.cc",
    "embedder/performance_manager_lifetime.h",
    "embedder/performance_manager_registry.h",
    "frame_priority/boosting_vote_aggregator.cc",
    "frame_priority/frame_priority.cc",
    "frame_priority/max_vote_aggregator.cc",
    "frame_priority/override_vote_aggregator.cc",
    "graph/frame_node.cc",
    "graph/frame_node_impl.cc",
    "graph/frame_node_impl.h",
    "graph/graph.cc",
    "graph/graph_impl.cc",
    "graph/graph_impl.h",
    "graph/graph_impl_operations.cc",
    "graph/graph_impl_operations.h",
    "graph/graph_operations.cc",
    "graph/node.cc",
    "graph/node_attached_data.cc",
    "graph/node_attached_data.h",
    "graph/node_attached_data_impl.h",
    "graph/node_base.cc",
    "graph/node_base.h",
    "graph/node_type.h",
    "graph/page_node.cc",
    "graph/page_node_impl.cc",
    "graph/page_node_impl.h",
    "graph/policies/process_priority_policy.cc",
    "graph/policies/process_priority_policy.h",
    "graph/process_node.cc",
    "graph/process_node_impl.cc",
    "graph/process_node_impl.h",
    "graph/properties.h",
    "graph/system_node.cc",
    "graph/system_node_impl.cc",
    "graph/system_node_impl.h",
    "graph/worker_node.cc",
    "graph/worker_node_impl.cc",
    "graph/worker_node_impl.h",
    "performance_manager.cc",
    "performance_manager_feature_observer_client.cc",
    "performance_manager_feature_observer_client.h",
    "performance_manager_impl.cc",
    "performance_manager_impl.h",
    "performance_manager_lifetime.cc",
    "performance_manager_registry.cc",
    "performance_manager_registry_impl.cc",
    "performance_manager_registry_impl.h",
    "performance_manager_tab_helper.cc",
    "performance_manager_tab_helper.h",
    "process_node_source.cc",
    "process_node_source.h",
    "public/decorators/page_live_state_decorator.h",
    "public/decorators/page_load_tracker_decorator_helper.h",
    "public/decorators/tab_properties_decorator.h",
    "public/frame_priority/boosting_vote_aggregator.h",
    "public/frame_priority/frame_priority.h",
    "public/frame_priority/max_vote_aggregator.h",
    "public/frame_priority/override_vote_aggregator.h",
    "public/graph/frame_node.h",
    "public/graph/graph.h",
    "public/graph/graph_operations.h",
    "public/graph/node.h",
    "public/graph/node_attached_data.h",
    "public/graph/page_node.h",
    "public/graph/policies/background_tab_loading_policy.h",
    "public/graph/process_node.h",
    "public/graph/system_node.h",
    "public/graph/worker_node.h",
    "public/performance_manager.h",
    "public/performance_manager_main_thread_observer.h",
    "public/render_process_host_proxy.h",
    "public/web_contents_proxy.h",
    "render_process_host_proxy.cc",
    "render_process_user_data.cc",
    "render_process_user_data.h",
    "service_worker_context_adapter.cc",
    "service_worker_context_adapter.h",
    "tab_helper_frame_node_source.cc",
    "tab_helper_frame_node_source.h",
    "web_contents_proxy.cc",
    "web_contents_proxy_impl.cc",
    "web_contents_proxy_impl.h",
    "worker_watcher.cc",
    "worker_watcher.h",
  ]
  public_deps = [
    "//base",
    "//base/allocator:buildflags",
    "//components/performance_manager/public/mojom",
    "//content/public/browser",
    "//services/metrics/public/cpp:metrics_cpp",
    "//url",
  ]
}

source_set("unit_tests") {
  testonly = true

  sources = [
    "decorators/decorators_utils_unittest.cc",
    "decorators/page_live_state_decorator_unittest.cc",
    "decorators/page_load_tracker_decorator_unittest.cc",
    "decorators/tab_properties_decorator_unittest.cc",
    "frame_priority/boosting_vote_aggregator_unittest.cc",
    "frame_priority/frame_priority_unittest.cc",
    "frame_priority/max_vote_aggregator_unittest.cc",
    "frame_priority/override_vote_aggregator_unittest.cc",
    "graph/frame_node_impl_unittest.cc",
    "graph/graph_impl_operations_unittest.cc",
    "graph/graph_impl_unittest.cc",
    "graph/graph_operations_unittest.cc",
    "graph/node_attached_data_unittest.cc",
    "graph/node_base_unittest.cc",
    "graph/page_node_impl_unittest.cc",
    "graph/policies/process_priority_policy_unittest.cc",
    "graph/process_node_impl_unittest.cc",
    "graph/properties_unittest.cc",
    "graph/system_node_impl_unittest.cc",
    "graph/worker_node_impl_unittest.cc",
    "performance_manager_impl_unittest.cc",
    "performance_manager_registry_impl_unittest.cc",
    "performance_manager_tab_helper_unittest.cc",
    "performance_manager_test_harness.cc",
    "performance_manager_test_harness.h",
    "performance_manager_unittest.cc",
    "web_contents_proxy_unittest.cc",
    "worker_watcher_unittest.cc",
  ]

  deps = [
    ":performance_manager",
    "test_support",
    "//base/test:test_support",
    "//content/test:test_support",
    "//testing/gmock",
    "//testing/gtest",
  ]
}
